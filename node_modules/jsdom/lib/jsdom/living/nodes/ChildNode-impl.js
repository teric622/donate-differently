"use strict";

const { convertNodesIntoNode } = require("../node");

class ChildNodeImpl {
  remove() {
    if (!this.parentNode) {
      return;
    }

<<<<<<< HEAD
    this.parentNode.removeChild(this);
=======
<<<<<<< HEAD
<<<<<<< HEAD
    this.parentNode.removeChild(this);
=======
    this.parentNode._remove(this);
>>>>>>> 782567c486993431d88a7d42ed2c18702ecdfd4f
=======
    this.parentNode.removeChild(this);
>>>>>>> b9690f13ae0b02552662ffbd680e2069f9283c9e
>>>>>>> 71cc80d5c04c1d732a53d72b3d4830571f913b17
  }

  after(...nodes) {
    const parent = this.parentNode;
    if (parent) {
      let viableNextSibling = this.nextSibling;
      let idx = viableNextSibling ? nodes.indexOf(viableNextSibling) : -1;

      while (idx !== -1) {
        viableNextSibling = viableNextSibling.nextSibling;
        if (!viableNextSibling) {
          break;
        }
        idx = nodes.indexOf(viableNextSibling);
      }
<<<<<<< HEAD
      parent.insertBefore(convertNodesIntoNode(this._ownerDocument, nodes), viableNextSibling);
=======
<<<<<<< HEAD
<<<<<<< HEAD
      parent.insertBefore(convertNodesIntoNode(this._ownerDocument, nodes), viableNextSibling);
=======

      parent._preInsert(convertNodesIntoNode(this._ownerDocument, nodes), viableNextSibling);
>>>>>>> 782567c486993431d88a7d42ed2c18702ecdfd4f
=======
      parent.insertBefore(convertNodesIntoNode(this._ownerDocument, nodes), viableNextSibling);
>>>>>>> b9690f13ae0b02552662ffbd680e2069f9283c9e
>>>>>>> 71cc80d5c04c1d732a53d72b3d4830571f913b17
    }
  }

  before(...nodes) {
    const parent = this.parentNode;
    if (parent) {
      let viablePreviousSibling = this.previousSibling;
      let idx = viablePreviousSibling ? nodes.indexOf(viablePreviousSibling) : -1;

      while (idx !== -1) {
        viablePreviousSibling = viablePreviousSibling.previousSibling;
        if (!viablePreviousSibling) {
          break;
        }
        idx = nodes.indexOf(viablePreviousSibling);
      }

<<<<<<< HEAD
      parent.insertBefore(
=======
<<<<<<< HEAD
<<<<<<< HEAD
      parent.insertBefore(
=======
      parent._preInsert(
>>>>>>> 782567c486993431d88a7d42ed2c18702ecdfd4f
=======
      parent.insertBefore(
>>>>>>> b9690f13ae0b02552662ffbd680e2069f9283c9e
>>>>>>> 71cc80d5c04c1d732a53d72b3d4830571f913b17
        convertNodesIntoNode(this._ownerDocument, nodes),
        viablePreviousSibling ? viablePreviousSibling.nextSibling : parent.firstChild
      );
    }
  }

  replaceWith(...nodes) {
    const parent = this.parentNode;
    if (parent) {
      let viableNextSibling = this.nextSibling;
      let idx = viableNextSibling ? nodes.indexOf(viableNextSibling) : -1;

      while (idx !== -1) {
        viableNextSibling = viableNextSibling.nextSibling;
        if (!viableNextSibling) {
          break;
        }
        idx = nodes.indexOf(viableNextSibling);
      }

      const node = convertNodesIntoNode(this._ownerDocument, nodes);

      if (this.parentNode === parent) {
<<<<<<< HEAD
        parent.replaceChild(node, this);
      } else {
        parent.insertBefore(node, viableNextSibling);
=======
<<<<<<< HEAD
<<<<<<< HEAD
        parent.replaceChild(node, this);
      } else {
        parent.insertBefore(node, viableNextSibling);
=======
        parent._replace(node, this);
      } else {
        parent._preInsert(node, viableNextSibling);
>>>>>>> 782567c486993431d88a7d42ed2c18702ecdfd4f
=======
        parent.replaceChild(node, this);
      } else {
        parent.insertBefore(node, viableNextSibling);
>>>>>>> b9690f13ae0b02552662ffbd680e2069f9283c9e
>>>>>>> 71cc80d5c04c1d732a53d72b3d4830571f913b17
      }
    }
  }
}

module.exports = {
  implementation: ChildNodeImpl
};
